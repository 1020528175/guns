package com.stylefeng.guns.core.beetl;

import com.stylefeng.guns.core.shiro.AuthKit;
import com.stylefeng.sso.plugin.model.LoginUser;

/**
 * 供给beetl用的鉴权工具
 *
 * @author fengshuonan
 * @Date 2018/8/30 上午10:28
 */
public class AuthExt {

    /**
     * 获取封装的 ShiroUser
     */
    public LoginUser getUser() {
        return AuthKit.getUser();
    }

    /**
     * 验证当前用户是否属于该角色？,使用时与lacksRole 搭配使用
     *
     * @param roleName 角色名
     * @return 属于该角色：true，否则false
     */
    public boolean hasRole(String roleName) {
        return AuthKit.hasRole(roleName);
    }

    /**
     * 与hasRole标签逻辑相反，当用户不属于该角色时验证通过。
     *
     * @param roleName 角色名
     * @return 不属于该角色：true，否则false
     */
    public boolean lacksRole(String roleName) {
        return !hasRole(roleName);
    }

    /**
     * 验证当前用户是否属于以下任意一个角色。
     *
     * @param roleNames 角色列表
     * @return 属于:true,否则false
     */
    public boolean hasAnyRoles(String roleNames) {
        return AuthKit.hasAnyRoles(roleNames);
    }

    /**
     * 验证当前用户是否拥有指定权限,使用时与lacksPermission 搭配使用
     *
     * @param permission 权限名
     * @return 拥有权限：true，否则false
     */
    public boolean hasPermission(String permission) {
        return AuthKit.hasPermission(permission);
    }

    /**
     * 与hasPermission标签逻辑相反，当前用户没有制定权限时，验证通过。
     *
     * @param permission 权限名
     * @return 拥有权限：true，否则false
     */
    public boolean lacksPermission(String permission) {
        return !hasPermission(permission);
    }

    /**
     * 已认证通过的用户。不包含已记住的用户，这是与user标签的区别所在。与notAuthenticated搭配使用
     *
     * @return 通过身份验证：true，否则false
     */
    public boolean authenticated() {
        return AuthKit.isAuthenticated();
    }

    /**
     * 未认证通过用户，与authenticated标签相对应。与guest标签的区别是，该标签包含已记住用户。。
     *
     * @return 没有通过身份验证：true，否则false
     */
    public boolean notAuthenticated() {
        return !authenticated();
    }

}
